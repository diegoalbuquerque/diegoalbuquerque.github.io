<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- iOS Safari -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <!-- Chrome, Firefox OS and Opera Status Bar Color -->
  <meta name="theme-color" content="#FFFFFF">
  <meta property="og:title" content="Pivoteando por T√∫neis">
    <meta name="description" content="Uma forma de criar t√∫nel usando ssh">
  <meta property="og:description" content="Uma forma de criar t√∫nel usando ssh">
    <meta property="og:type" content="blog">
  <title>Pivoteando por T√∫neis</title>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
  <link rel="stylesheet" type="text/css"
    href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
  <link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
  <link rel="stylesheet" type="text/css" href="css/notablog.css">
  <link rel="stylesheet" type="text/css" href="css/theme.css">
  <style>
    :root {
      font-size: 18px;
    }

    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
    <a href="index.html">
      <div class="Navbar__Btn"><span>üìñ</span> <span>Home</span></div>
    </a>
                                                                                                    <span class="Navbar__Delim">&centerdot;</span>
    <a href="about.html">
      <div class="Navbar__Btn"><span>‚ÅâÔ∏è</span> <span>About</span></div>
    </a>
                          </nav>
  <header class="Header">
          <div class="Header__Cover">
        <img src="https://www.notion.so/images/page-cover/nasa_eagle_in_lunar_orbit.jpg">
      </div>
          <div class="Header__Spacer ">
    </div>
        <div class="Header__Icon"><span>‚õìÔ∏è</span></div>
        <h1 class="Header__Title">Pivoteando por T√∫neis</h1>
            <div class="DateTagBar">
                <span class="DateTagBar__Item DateTagBar__Date">Posted on Fri, Aug 7, 2020</span>
                          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--blue">
            <a href="tag/techinique.html">techinique</a>
          </span>
                <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--brown">
            <a href="tag/pivoting.html">pivoting</a>
          </span>
                  </div>
          </header>
      <article id="https://www.notion.so/3723a3d1257e40fbbf73712f0851b3f4" class="PageRoot"><blockquote id="https://www.notion.so/a54c392c7ea840feb9da1c1e6ebf123f" class="ColorfulBlock ColorfulBlock--ColorDefault Quote"><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">Em uma rede interna distante cheia de m√°quinas quaisquer prontinhas para serem invadidas  ...</em></mark></span></span></blockquote><h1 id="https://www.notion.so/b95a7c01b33c45f79b40e7f238521635" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/b95a7c01b33c45f79b40e7f238521635"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">TL; TR; √â grande demais para ler</span></span></h1><div id="https://www.notion.so/3125acae6c524261a4cd941adcc9ac44" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Vamos criar um t√∫nel entre nosso kali e uma m√°quina invadida para poder, atrav√©s dela, acessar outra rede.</span></span></p></div><div id="https://www.notion.so/d73e2346175f4582a09570fe26a7dce3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Pr√©-requisitos para a m√°quina invadida (v√≠tima)</strong></span></span></p></div><details id="https://www.notion.so/475323e12176407e98318da8395a4e3a" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle"><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">Acesso SSH </span></span></summary><div class="Toggle__Content"></div></details><details id="https://www.notion.so/8c5a664de8124efcad811fab28f0ac4f" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle"><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">Acesso Root</span></span></summary><div class="Toggle__Content"></div></details><details id="https://www.notion.so/88c516092ec748caa0a323a97a20c7e3" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle"><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">PermitTunnel yes no sshd_config</span></span></summary><div class="Toggle__Content"></div></details><div id="https://www.notion.so/f01b137df17242d49c71b28fa2e40368" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Configura√ß√µes assumidas</strong></span></span></p></div><details id="https://www.notion.so/9ed8d6d7b738476d90536ff42bf46f3b" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle"><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">Kali : IP: 192.168.1.5</span></span></summary><div class="Toggle__Content"></div></details><details id="https://www.notion.so/12d09237146c4649be2d5984dec80d2f" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle"><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">Vitima: IP: 192.168.1.2 | Interface na rede interna: eth1</span></span></summary><div class="Toggle__Content"></div></details><details id="https://www.notion.so/fbee7350a9fd420aa1d63e92ff2b17e2" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle"><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">Rede Interna que se deseja Acessar: 192.168.56.0/24</span></span></summary><div class="Toggle__Content"></div></details><details id="https://www.notion.so/8d9e7d5e7fb34786ba7dda19d2a67bb5" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle"><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">IPs do t√∫nel : 10.10.10.1/32 e 10.10.10.2/32</span></span></summary><div class="Toggle__Content"></div></details><div id="https://www.notion.so/d113f6224c624ed0a421316ccac431dd" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/8f538f9b8f774a15bfaf43cf7e39f1de" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Observe o PROMPT para verificar em que m√°quina est√° sendo executado os comandos:</span></span></p></div><div id="https://www.notion.so/02c1790b863d41408ce934fdbb03a5ff" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"> </span></span></p></div><pre id="https://www.notion.so/621bd6b8057740b1901fb3c6acee3d9a" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed"><span>root@kali</span></mark></strong></span><span class="SemanticString"><span>:/tmp# ssh -w0:0 root@192.168.1.2
</span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><span>root@kali</span></strong></mark></span><span class="SemanticString"><span>:/home/kali# ip addr add 10.10.10.1/32 peer 10.10.10.2 dev tun0
</span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><span>root@kali</span></strong></mark></span><span class="SemanticString"><span>:/home/kali# ip link set up tun0
</span></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed"><span>root@kali</span></mark></strong></span><span class="SemanticString"><span>:/home/kali# ip route add 192.168.56.0/24 via 10.10.10.2

</span></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen"><span>root@webserver</span></mark></strong></span><span class="SemanticString"><span>:~# ip addr add 10.10.10.2/32 peer 10.10.10.1 dev tun0
</span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><span>root@webserver</span></strong></mark></span><span class="SemanticString"><span>:~# ip link set up tun0
</span></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen"><span>root@webserver</span></mark></strong></span><span class="SemanticString"><span>:~# sysctl net.ipv4.ip_forward=1
net.ipv4.ip_forward = 1
</span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorGreen"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><span>root@webserver</span></strong></mark></span><span class="SemanticString"><span>:~# iptables -t nat -A POSTROUTING -o eth1 -j MASQUERADE</span></span></span></code></pre><h1 id="https://www.notion.so/9028e51f1cf142b6a7c2f1c31d1f8d1b" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/9028e51f1cf142b6a7c2f1c31d1f8d1b"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Intro</span></span></h1><div id="https://www.notion.so/07b1407935c340369e5bf2439fa1802b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/fb6ed836cec5427c99e9e6c08a18a55a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Este √© um exerc√≠cio de Post-Exploitation, ou seja, partiremos do princ√≠pio que a m√°quina j√° foi invadida e que </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">voc√™ j√° possui root</strong></span><span class="SemanticString">!</span></span></p></div><div id="https://www.notion.so/488b1cb9aaef4b4e8336e7b65af26ef3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Existem N op√ß√µes de pivoteamento e esta que vou apresentar √© uma delas. A id√©ia √© n√£o se preocupar em ficar configurando redirecionamento de portas e permitir o acesso direto a rede desejada, passando por uma m√°quina invadida, permitindo pivotear de uma rede externa, por exemplo, para uma rede Interna. </span></span></p></div><div id="https://www.notion.so/863b69cda8ef449b8eb281ca8cc99267" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/f8112c606b7a4d36950a08cc06469310" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Imagine o seguinte cen√°rio montado como LAB. </span></span></p></div><div id="https://www.notion.so/0b7d787bd1dc48fb86fb0c669433d851" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F2549b8be-b64d-4bb8-8c40-96c671dea465%2FUntitled.png?width=946"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F2549b8be-b64d-4bb8-8c40-96c671dea465%2FUntitled.png?width=946" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/f54a70f6171c40b3afe7e0a1fa0a3a24" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">O atacante j√° comprometeu uma das m√°quinas da rede 192.168.1.0/24 e tamb√©m a m√°quina 192.168.1.2 (Web Server) e viu que ela possui uma interface de liga√ß√£o com a rede 192.168.56.0/24.  </span></span></p></div><div id="https://www.notion.so/65c93b7caf6b428693d0ad5f1134c9eb" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Da m√°quina dele (192.168.1.5) ele, que possui todas as ferramentas que ele precisa, ele n√£o consegue sequer escanear a nova rede.  </span></span></p></div><div id="https://www.notion.so/3c0e222ffed14a49b90232f5afb9c1a6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Uma vez comprometida uma m√°quina , caso voc√™ possua credenciais de root , √© poss√≠vel criar um t√∫nel entre a m√°quina invadida e sua m√°quina externa (um kali por exemplo) que permita voc√™ mapear uma outra rede a qual a m√°quina invadidada est√° conectada.</span></span></p></div><div id="https://www.notion.so/5b660c8f3e6f40f79cd7326d395cabf1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Vamos a configura√ß√£o</span></span></p></div><div id="https://www.notion.so/d94a31363cf147da9b911f121e675105" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">M√°quina Invadida (webserver) j√° com usu√°rio com permiss√µes de root</strong></span></span></p></div><pre id="https://www.notion.so/37db37f1c97d4487a7c49eacee1ec356" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><span>root@webserver</span></strong></mark></span><span class="SemanticString"><span>:/tmp# ip -br addr show
lo               UNKNOWN        127.0.0.1/8 ::1/128 
eth0             UP             192.168.1.2/24 fe80::7d82:995d:21fe:7a0a/64 
eth1             UP             192.168.56.143/24 fe80::a3fa:bc:9a30:39ba/64 
root@webserver:/tmp# 
root@webserver:~# ping -c1 192.168.56.128
PING 192.168.56.128 (192.168.56.128) 56(84) bytes of data.
64 bytes from 192.168.56.128: icmp_seq=1 ttl=64 time=0.528 ms

--- 192.168.56.128 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.528/0.528/0.528/0.000 ms
root@webserver:~#</span></span></span></code></pre><div id="https://www.notion.so/544960c139ad45959b373ca09b7ac620" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">M√°quina do atacante (kali)</strong></span></span></p></div><pre id="https://www.notion.so/f55a1f2175694326a6c1578b36440dd5" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><span>root@kali:</span></strong></mark></span><span class="SemanticString"><span>/tmp# ip -br addr show
lo               UNKNOWN        127.0.0.1/8 ::1/128 
eth0             UP             192.168.86.29/24 fe80::20c:29ff:febe:46e9/64 
eth1             UP             192.168.1.5/24 fe80::51ba:65d0:e569:2ddb/64 
root@kali:/tmp#
root@kali:/tmp# ping -c1 192.168.56.128
PING 192.168.56.128 (192.168.56.128) 56(84) bytes of data.

--- 192.168.56.128 ping statistics ---
1 packets transmitted, 0 received, </span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedBg SemanticString__Fragment--BgRed"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><span>100% packet loss</span></strong></mark></span><span class="SemanticString"><span>, time 0ms</span></span></span></code></pre><div id="https://www.notion.so/51ff6765125643a1a1645e0e6f74f88a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h2 id="https://www.notion.so/39bd7408957a4b85b5563137b0ecca35" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/39bd7408957a4b85b5563137b0ecca35"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Montando o t√∫nel</span></span></h2><h3 id="https://www.notion.so/c7bec4c75c404bad9fe593cb6fda497a" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--3"><a class="Anchor" href="#https://www.notion.so/c7bec4c75c404bad9fe593cb6fda497a"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Pr√©-requisitos</span></span></h3><details id="https://www.notion.so/8fcbf317b4b74b7b88c9f4a70fdc48c4" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle"><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">root na m√°quina invadida</span></span></summary><div class="Toggle__Content"></div></details><details id="https://www.notion.so/8d5112819d54426ca443c09e2422d966" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle"><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">acesso ssh na m√°quina invadida</span></span></summary><div class="Toggle__Content"></div></details><details id="https://www.notion.so/ca12bde1d6f24fd6aa4eae2133445a3f" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle"><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">op√ß√£o PermitTunnel yes no sshd_config da v√≠tima (voc√™ √© root, isso voc√™ d√° um jeito!)</span></span></summary><div class="Toggle__Content"></div></details><div id="https://www.notion.so/4219a637241c48fba88332ae56b371f1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h2 id="https://www.notion.so/35ff6da78b624a408e0232e31b61e778" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/35ff6da78b624a408e0232e31b61e778"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Passo 1 - no kali - Criar interfaces tun0</span></span></h2><div id="https://www.notion.so/8c8c1f4ccb294a1188811d0af2c57f59" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/b599923079514630a2bbba0b932131b5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">No kali, m√°quina atacante, vamos conectar via ssh a m√°quina invadida (192.168.1.2) solicitando que seja seja criado um tunel device em ambas as pontas ( Op√ß√£o -w do ssh. man ssh √© seu amigo!)</span></span></p></div><pre id="https://www.notion.so/aeaab16a820943939291d505b88c7d0a" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>root@kali:/tmp# ssh -w0:0 root@192.168.1.2</span></span></span></code></pre><div id="https://www.notion.so/e22ac3f3e06043b6bf993b591152aac7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/3926102e440b456c943a3024e551c25c" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F4b4a045f-bcc9-42c4-8071-f200a601e16f%2FUntitled.png?width=679"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F4b4a045f-bcc9-42c4-8071-f200a601e16f%2FUntitled.png?width=679" style="width:679px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/fc245a9f8288406696a19e49f441b4a0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/8f2fa5c0512543efb5674f0f1be403ae" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"> Observe que foram criadas interfaces tun0, que n√£o existiam, em ambas as m√°quinas.</span></span></p></div><div id="https://www.notion.so/ef4f4099966149909498c1865eea6427" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/b99eb9e7645743baa185a7a07ceb9e54" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F2b2b9869-4aa7-4451-ae92-3f95640aa4a2%2FUntitled.png?width=856"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F2b2b9869-4aa7-4451-ae92-3f95640aa4a2%2FUntitled.png?width=856" style="width:100%"/></a><figcaption><span class="SemanticStringArray"><span class="SemanticString">no kali atacante</span></span></figcaption></figure></div><div id="https://www.notion.so/a03075d05ea24d7496f93adda1289dad" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F48b16b6f-4cb5-4243-ba05-c040025d7311%2FUntitled.png?width=862"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F48b16b6f-4cb5-4243-ba05-c040025d7311%2FUntitled.png?width=862" style="width:100%"/></a><figcaption><span class="SemanticStringArray"><span class="SemanticString">na m√°quina invadida</span></span></figcaption></figure></div><h2 id="https://www.notion.so/57ae5760811e49d189fd3b4589609acf" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/57ae5760811e49d189fd3b4589609acf"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Passo 2 - No kali e na Vitima - Configurar os IPs</span></span></h2><div id="https://www.notion.so/23b12868f50941bcaf1c492006c1bf6f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/f7663eeacd0844b5889394d49b58fcc6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Vamos agora configurar as duas pontas do tunel: M√°quina Invadida e Kali. Uma ponta vamos configurar com o IP 10.10.10.1 e na outra ponta com o IP 10.10.10.2. A id√©ia √© que ambas as pontas se comuniquem como se estivessem ligadas via cabo direto! Os IPs foram escolhidos a gosto do fregu√™s. </span></span></p></div><details id="https://www.notion.so/012efaaed7f940b98a4e599d9b7dcf73" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle"><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">kali : 10.10.10.1 </span></span></summary><div class="Toggle__Content"></div></details><details id="https://www.notion.so/cda00c69d4954e1c991b5cde2571ae35" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle"><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">vitima: 10.10.10.2</span></span></summary><div class="Toggle__Content"></div></details><div id="https://www.notion.so/2f58acb240b04540b0361a9d1a865f5c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">No kali </strong></span></span></p></div><pre id="https://www.notion.so/b33234f4360b441c9a5611ac6762ee5c" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>root@kali:/home/kali# ip addr add 10.10.10.1/32 peer 10.10.10.2 dev tun0
root@kali:/home/kali# ip link set up tun0
root@kali:/home/kali# ip -br addr show
lo               UNKNOWN        127.0.0.1/8 ::1/128 
eth0             UP             192.168.86.29/24 fe80::20c:29ff:febe:46e9/64 
eth1             UP             192.168.1.5/24 fe80::51ba:65d0:e569:2ddb/64 
</span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><span>tun0             UNKNOWN        10.10.10.1 peer 10.10.10.2/32 fe80::a631:728:1d86:5f72/64</span></strong></mark></span><span class="SemanticString"><span> 
root@kali:/home/kali#</span></span></span></code></pre><div id="https://www.notion.so/92d262e303c2408ea56c4bda39082464" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Na m√°quina invadida </strong></span></span></p></div><pre id="https://www.notion.so/4d1245d4404349b6ba1432c8bea59df8" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>root@webserver:~# ip addr add 10.10.10.2/32 peer 10.10.10.1 dev tun0
root@webserver:~# ip link set up tun0
root@webserver:~# ip -br addr show
lo               UNKNOWN        127.0.0.1/8 ::1/128 
eth0             UP             192.168.1.2/24 fe80::7d82:995d:21fe:7a0a/64 
eth1             UP             192.168.56.143/24 fe80::a3fa:bc:9a30:39ba/64 
</span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><span>tun0             UNKNOWN        10.10.10.2 peer 10.10.10.1/32 fe80::6849:52a3:d22f:fe5a/64 </span></strong></mark></span><span class="SemanticString"><span>
root@webserver:~#</span></span></span></code></pre><div id="https://www.notion.so/dc46368bed01454198b0fb746b754b76" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">‚ÅâÔ∏è</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed">Aten√ß√£o! </mark></span><span class="SemanticString">Observe que os comandos s√£o os mesmos apenas invertemos os IPs. O que estamos dizendo √© que um IP de um lado tem como par o IP do outro lado.</span></span></p></div><div id="https://www.notion.so/42baf9b4f46f47a197895f99acf96426" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Neste momento as duas m√°quinas est√£o conectadas pelo t√∫nel e j√° consegue trafegar dados por ele. Observe o ping de uma para outra:</span></span></p></div><div id="https://www.notion.so/b347898c33dc42dfa2d7577543cdbd68" class="ColumnList"><div id="https://www.notion.so/7386a27b7b964d32888c26116b1c033c" class="Column" style="width:calc((100% - var(--column-spacing) * 1) * 0.5)"><div id="https://www.notion.so/42a0237fbd5b4d59ae227eba67357776" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F54a68240-671e-4f95-bba3-e938bfe793da%2FUntitled.png?width=496"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F54a68240-671e-4f95-bba3-e938bfe793da%2FUntitled.png?width=496" style="width:496px"/></a><figcaption><span class="SemanticStringArray"><span class="SemanticString">kali ‚Üí ping vitima </span></span></figcaption></figure></div></div><div id="https://www.notion.so/9579f3eb8eaa45628c0da5f7cec07f18" class="Column" style="width:calc((100% - var(--column-spacing) * 1) * 0.5);margin-left:var(--column-spacing)"><div id="https://www.notion.so/609253576dad4a97b3248c0cdd255a02" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F70ef84b1-13b6-4c66-8362-3eeee392dd0b%2FUntitled.png?width=500"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F70ef84b1-13b6-4c66-8362-3eeee392dd0b%2FUntitled.png?width=500" style="width:500px"/></a><figcaption><span class="SemanticStringArray"><span class="SemanticString">vitima ‚Üí ping kali</span></span></figcaption></figure></div></div></div><h2 id="https://www.notion.so/ff8c42d288b9454381c3c62cc1af4165" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/ff8c42d288b9454381c3c62cc1af4165"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Passo 3 - na vitima - configurar encaminhamento</span></span></h2><div id="https://www.notion.so/dff5786af11b491890a0472d5a6afbb2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">N√£o √© porque o t√∫nel est√° estabelecido que j√° conseguimos acessar a rede 192.168.56.0/24. Observe o resultado, a partir do kali, para a m√°quina Intranet Server do lab (192.168.56.143). </span></span></p></div><div id="https://www.notion.so/bdf1128eb5ee4073b902dc4c3cf5d0c3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/de67a152d98c48749a7f2afafb5b6c38" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F393a5dfe-2529-497e-b0ef-7617bf0869a4%2FUntitled.png?width=524"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2F393a5dfe-2529-497e-b0ef-7617bf0869a4%2FUntitled.png?width=524" style="width:524px"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/0968f145667f40b093b7fa0605d4759c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Vamos agora configurar, </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">na m√°quina invadida</strong></span><span class="SemanticString">, o roteamento, para que todo pacote que venha do kali com destino a rede 192.168.56.0/24 seja devidamente encaminhado. </span></span></p></div><div id="https://www.notion.so/0d66390dfdd143859bdd77aff341266e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Pr√©-requisito</strong></span></span></p></div><details id="https://www.notion.so/7991743bcfe04fd9afdb56546af6c51f" class="ColorfulBlock ColorfulBlock--ColorDefault Toggle"><summary class="Toggle__Summary"><span class="SemanticStringArray"><span class="SemanticString">Qual a interface que conecta a m√°quina na rede desejada (</span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">eth1</strong></span><span class="SemanticString">)</span></span></summary><div class="Toggle__Content"></div></details><div id="https://www.notion.so/be360aa129e444e49689882bc20ec4dd" class="Image Image--PageWidth"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fb92e6ed4-c24b-49ed-b7e6-5dbb6b1b1a2f%2FUntitled.png?width=743"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fb92e6ed4-c24b-49ed-b7e6-5dbb6b1b1a2f%2FUntitled.png?width=743" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><pre id="https://www.notion.so/1e730da578a34273b102f3fb75ce4643" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>root@webserver:~# sysctl net.ipv4.ip_forward=1
net.ipv4.ip_forward = 1
root@webserver:~# iptables -t nat -A POSTROUTING -o eth1 -j MASQUERADE
root@webserver:~#</span></span></span></code></pre><div id="https://www.notion.so/91301b578a1f408ca9596926a0c3d30d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h2 id="https://www.notion.so/70cf90858c3e4d539c131ea078bf1194" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/70cf90858c3e4d539c131ea078bf1194"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Passo 4 - no kali - configurar roteamento</span></span></h2><pre id="https://www.notion.so/86cdb432f3a34ef79f0409b0b476cb1b" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>root@kali:/home/kali# ip route add 192.168.56.0/24 via 10.10.10.2</span></span></span></code></pre><div id="https://www.notion.so/d91272e3b26f48e4ac7494befbb58944" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/4629dc8e157e44b0b9b2e9b96875a60c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">‚ÅâÔ∏è</span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorRed">Aten√ß√£o!</mark></span><span class="SemanticString"> Observe que o IP de destino da rota √© o IP associado a ponta do t√∫nel na v√≠tima!</span></span></p></div><div id="https://www.notion.so/9479e7daa2d24eac9b2bb66b9974bedc" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/71dbc3d7243744b98a0b1df592ffa919" class="Image Image--Normal"><figure><a href="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fceebc7bb-7795-4afa-a01f-86d3c6757f9d%2FUntitled.png?width=527"><img src="https://www.notion.so/signed/https%3A%2F%2Fs3-us-west-2.amazonaws.com%2Fsecure.notion-static.com%2Fceebc7bb-7795-4afa-a01f-86d3c6757f9d%2FUntitled.png?width=527" style="width:527px"/></a><figcaption><span class="SemanticStringArray"><span class="SemanticString">Kali pingando a nova rede, agora acess√≠vel.</span></span></figcaption></figure></div><div id="https://www.notion.so/d6a21fc9cfd34f01a7c6f27024218b0d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Alguns comandos que podem ser √∫teis caso precise desabilitar interfaces, remover regras de iptables, etc.</span></span></p></div><pre id="https://www.notion.so/e317ea8134d0422a9cdb5e3bbbb51a19" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>iptables -L --line-numbers
iptables -F
ip link del &lt;device&gt;</span></span></span></code></pre><div id="https://www.notion.so/fb607688c35e4bc595c8a927654d3916" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h2 id="https://www.notion.so/86f7a837b3994385ae8e20d7d94dde80" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/86f7a837b3994385ae8e20d7d94dde80"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Script Automatizado</span></span></h2><div id="https://www.notion.so/f3d60b79e57d48d79337c34992747f6f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><pre id="https://www.notion.so/b553cdc0e77f4508874759a3d7d67b0e" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>#!/bin/bash

# man ssh
# -f      Requests ssh to go to background just before command execution.
# -T      Disable pseudo-terminal allocation.
# -C      Requests compression of all data
# -o ServerAliveInterval=30
#             Sets a timeout interval in seconds after which if no data has
#             been received from the server, ssh(1) will send a message through
#             the encrypted channel to request a response from the server.  The
#             default is 0, indicating that these messages will not be sent to
#             the server.  This option applies to protocol version 2 only.
# -o ExitOnForwardFailure=yes
#             According to the ssh man page, this option will cause &quot;a client 
#             started with -f [to] wait for all remote port forwards to be 
#             successfully established before placing itself in the background&quot;.

IP_VITIMA=192.168.1.2  # Altere Aqui
INTERFACE_REDE_INTERNA_VITIMA=eth1 # Altere Aqui
REDE_INTERNA_ALVO=192.168.56.0/24 # Altere Aqui

echo &quot;[+] Configurando tunel na vitima &quot;
ssh -w0:0 root@$IP_VITIMA -fTC -oServerAliveInterval=30 -o ExitOnForwardFailure=yes &quot;ip addr add 10.10.10.2/32 peer 10.10.10.1 dev tun0; ip link set up tun0; sysctl net.ipv4.ip_forward=1; iptables -t nat -A POSTROUTING -o $INTERFACE_REDE_INTERNA_VITIMA -j MASQUERADE&quot; 

ip addr add 10.10.10.1/32 peer 10.10.10.2 dev tun0
ip link set up tun0
ip route add $REDE_INTERNA_ALVO via 10.10.10.2

</span></span></span></code></pre><div id="https://www.notion.so/db7348fd1ddb449fbe8305a0366d94d5" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><blockquote id="https://www.notion.so/8a7426b8a0e64ce18e1c3f94a04efd67" class="ColorfulBlock ColorfulBlock--ColorDefault Quote"><span class="SemanticStringArray"><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">Este texto foi desenvolvido para estudo pr√≥prio e melhor entendimento do que explica o artigo abaixo. √â bem dizer uma tradu√ß√£o com mais explica√ß√µes. Todos os cr√©ditos para o autor original do artigo.</em></span></span></blockquote><div id="https://www.notion.so/164f6cb2146444beade2de2189cd0ef1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/8a06baec6158422ebc7d84e6a41442e7" class="Bookmark"><a href="https://medium.com/@mishrasunny174/pivoting-to-internal-networks-using-ssh-like-a-boss-be1cd9c5ac0f"><h5 class="Bookmark__Title">Pivoting to internal networks using ssh like a boss</h5><p class="Bookmark__Desc">Recently I was solving a lab in which I needed to pivot to the internal network of the victim machine so I started doing some research and I came across the idea of VPN over SSH and I thought I can...</p><p class="Bookmark__Link">https://medium.com/@mishrasunny174/pivoting-to-internal-networks-using-ssh-like-a-boss-be1cd9c5ac0f</p></a></div><h1 id="https://www.notion.so/a8a172a480824faf9f295e2f6b707431" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--1"><a class="Anchor" href="#https://www.notion.so/a8a172a480824faf9f295e2f6b707431"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Outras Refer√™ncias</span></span></h1><div id="https://www.notion.so/5e78b3931d444ffba692a172ea22d6bd" class="Bookmark"><a href="https://til.hashrocket.com/posts/8kvvskdkhs-keeping-an-ssh-connection-alive"><h5 class="Bookmark__Title">Today I Learned</h5><p class="Bookmark__Desc">Do you get disconnected from your SSH session often? I do... but I&#x27;ve found a solution that helps. An SSH configuration that can be made on the server or client side but in my instance it makes more sense for the update to be on the client side.</p><p class="Bookmark__Link">https://til.hashrocket.com/posts/8kvvskdkhs-keeping-an-ssh-connection-alive</p></a></div></article>  <footer class="Footer">
        <div>&copy; inDex 2019</div>
        <div>&centerdot;</div>
        <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
            rel="noopener noreferrer">Notablog</a>.
        </div>
    </footer>
</body>

</html><!-- to change cache -->
